<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Profit Simulation Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #0b2b15; /* Dark green background */
    color: #fff;
    margin: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  h1 {
    text-align: center;
  }

  #wallet {
    margin: 10px 0;
  }

  #balance {
    font-size: 1.2em;
    margin-top: 5px;
  }

  #profitDisplay {
    font-size: 2em;
    margin: 20px 0;
    padding: 20px;
    background-color: #1f4f35; /* slightly lighter for contrast */
    border-radius: 10px;
    min-width: 300px;
    text-align: center;
  }

  #controls {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 20px;
    justify-content: center;
  }

  input[type=number] {
    width: 80px;
  }

  button {
    padding: 10px 20px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    background-color: #28a745;
    color: white;
  }

  button:disabled {
    background-color: #555;
    cursor: not-allowed;
  }

  #status {
    margin-top: 10px;
    font-weight: bold;
  }
</style>
</head>
<body>

<h1>Profit Increasing Balance Demo</h1>

<!-- Wallet connect button -->
<button id="connectWalletBtn">Connect Wallet</button>

<div id="wallet" style="display:none;">
  <div>Wallet Address:</div>
  <div id="walletAddress">-</div>
  <div id="balance">USDC Balance: -</div>
</div>

<!-- Display for simulated profit -->
<div id="profitDisplay">Profit: 0.00 USDC</div>

<!-- Controls -->
<div id="controls">
  <label>Scan Interval (sec):</label>
  <input type="number" id="scanSpeed" value="10" min="1" max="60" />
  <button id="startBtn">Start Scanning</button>
  <button id="stopBtn" disabled>Stop Scanning</button>
  <label style="margin-left:20px;">Min Profit (USDC):</label>
  <input type="number" id="minProfit" value="10" min="1" />
</div>

<div id="status">Status: Idle</div>

<script>
let provider;
let signer;
let walletAddress = '';
let usdcBalance = 0;

// Simulation variables
let profit = 0;
let profitIntervalId = null;

// UI elements
const connectBtn = document.getElementById('connectWalletBtn');
const walletDiv = document.getElementById('wallet');
const walletAddressDiv = document.getElementById('walletAddress');
const balanceDiv = document.getElementById('balance');
const profitDiv = document.getElementById('profitDisplay');
const startBtn = document.getElementById('startBtn');
const stopBtn = document.getElementById('stopBtn');
const scanSpeedInput = document.getElementById('scanSpeed');
const minProfitInput = document.getElementById('minProfit');
const statusDiv = document.getElementById('status');

async function connectWallet() {
  if (!window.ethereum) {
    alert('Please install MetaMask!');
    return;
  }
  try {
    provider = new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts", []);
    signer = provider.getSigner();
    walletAddress = await signer.getAddress();

    walletAddressDiv.textContent = walletAddress;
    document.getElementById('wallet').style.display = 'block';

    // For demo purposes, generate a mock USDC balance
    // In real usage, fetch from a USDC token contract:
    // const usdcContract = new ethers.Contract(usdcAddress, usdcAbi, provider);
    // const balance = await usdcContract.balanceOf(walletAddress);
    // usdcBalance = ethers.utils.formatUnits(balance, 6);
    usdcBalance = 1000.00; // Mock balance
    balanceDiv.textContent = `USDC Balance: ${usdcBalance.toFixed(2)}`;

    connectBtn.disabled = true;
    document.getElementById('status').textContent = 'Wallet connected.';
    startBtn.disabled = false;

  } catch (err) {
    alert('Error connecting wallet: ' + err.message);
  }
}

function updateProfitDisplay() {
  profitDiv.textContent = `Profit: ${profit.toFixed(2)} USDC`;
}

function startScanning() {
  const intervalSec = parseInt(scanSpeedInput.value);
  if (isNaN(intervalSec) || intervalSec < 1) {
    alert('Invalid scan interval.');
    return;
  }
  if (profitIntervalId) clearInterval(profitIntervalId);
  profitIntervalId = setInterval(() => {
    // Only simulate profit if profit >= min profit
    const minProfit = parseFloat(minProfitInput.value);
    // Increase profit: simulate steady gain
    profit += (Math.random() * 5 + 1); // increase by a random amount between 1-6
    updateProfitDisplay();

    // Ensure profit does not go below min profit (simulate only upon condition)
    if (profit >= minProfit) {
      document.body.style.backgroundColor = '#006400'; // dark green
    }
    document.getElementById('status').textContent = 'Scanning...';
  }, intervalSec * 1000);

  startBtn.disabled = true;
  stopBtn.disabled = false;
  document.getElementById('status').textContent = 'Scanning started.';
}

function stopScanning() {
  if (profitIntervalId) {
    clearInterval(profitIntervalId);
    profitIntervalId = null;
  }
  document.getElementById('status').textContent = 'Scanning stopped.';
  startBtn.disabled = false;
  stopBtn.disabled = true;
  document.body.style.backgroundColor = '#0b2b15'; // reset background
}

document.getElementById('connectWalletBtn').onclick = connectWallet;
document.getElementById('startBtn').onclick = startScanning;
document.getElementById('stopBtn').onclick = stopScanning;

// Initialize
window.onload = () => {
  document.getElementById('status').textContent = 'Idle.';
};
</script>

<!-- Include ethers.js library -->
<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
</body>
</html>
